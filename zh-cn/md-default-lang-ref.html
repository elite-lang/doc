<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Elite: 默认语法文档</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygenextra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="topbanner"><a href="https://github.com/elite-lang/Elite" title="Elite GitHub Repository"><i class="githublogo"></i></a></div>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="搜索" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'搜索');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md-default-lang-ref.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>全部</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>类</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>命名空间</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>文件</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>函数</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>变量</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>类型定义</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>枚举</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>枚举值</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>友元</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>宏定义</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>页</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">默认语法文档 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>目录</h3>
<ul><li class="level1"><a href="#lang-ref-intro">语法简介</a></li>
<li class="level1"><a href="#lang-ref-basic">基本语法结构</a><ul><li class="level2"><a href="#lang-ref-basic-control">控制流程</a></li>
<li class="level2"><a href="#lang-ref-basic-types">类型系统</a></li>
<li class="level2"><a href="#lang-ref-basic-memory">内存管理</a></li>
</ul>
</li>
<li class="level1"><a href="#lang-ref-macro">强大的宏机制</a></li>
</ul>
</div>
<div class="textblock"><p>虽然ELite语言是一门语法可变的语言，但为了方便开发者使用，我们还是开发了默认的常用语法和可选的语言扩展包，这些都可以根据您的实际项目进行修改配置，本章将会介绍Elite语言的默认语言和将其作为基本的通用编程语言使用方法。</p>
<h1><a class="anchor" id="lang-ref-intro"></a>
语法简介</h1>
<p>这是一款类C语言语法，使用C语言的用户可以很方便的适应这种写法，当然，Elite默认语法也有一些小的不同。 下面是一段Hello World代码示例： </p>
<pre class="fragment">int main() {
    hello();
    return 0;
}

void hello() {
    printf("hello world ～ Elite !");
}
</pre><p>和C语言一样，基本的函数定义语法，并且printf函数都是原生的C语言函数。</p>
<p>我们注意到一个细节，Elite是一种非前向声明型语言，任何一个函数，只需要您定义过，它就能够在任意位置被找到，原因是我们使用了多遍扫描技术，我们会有单独的趟去处理结构体和函数的声明问题。</p>
<p>不过需要注意的是，函数内部并非是无需前向声明的，函数内部变量的定义和C语言是一致的，并且也拥有作用域的概念。</p>
<h1><a class="anchor" id="lang-ref-basic"></a>
基本语法结构</h1>
<h2><a class="anchor" id="lang-ref-basic-control"></a>
控制流程</h2>
<p>Elite默认语法提供类似C语言的<code>if-else</code>，<code>while</code>，<code>for</code>，<code>return</code>等基本控制语句 使用方式和C语言几乎一致： </p>
<pre class="fragment">void hello(int k, int g) {
    int y = k + g;
    printf("%d\n", y);
    if (k + g &lt; 5) printf("right\n");
}   

void go(int k) {
    int a = 0;
    while (a &lt; k) {
        printf("go-%d\n", a);
        a = a + 1;
    }
}

void print(int k) {
    for (int i = 0; i &lt; 10; i = i+1) {
        printf("hello-%d\n",i);
    } 
}
</pre><h2><a class="anchor" id="lang-ref-basic-types"></a>
类型系统</h2>
<h4>基本类型</h4>
<p>Elite提供基本的C语言类型，默认内置的类型有以下： </p>
<table class="doxtable">
<tr>
<th>类型名 </th><th>描述  </th></tr>
<tr>
<td>void </td><td>空类型 </td></tr>
<tr>
<td>int </td><td>64位整形 </td></tr>
<tr>
<td>float </td><td>单精度浮点型 </td></tr>
<tr>
<td>double </td><td>双精度浮点型 </td></tr>
<tr>
<td>byte </td><td>8位字节 </td></tr>
<tr>
<td>char </td><td>8位C语言字符类型 </td></tr>
<tr>
<td>wchar </td><td>32位多国语言宽字符型 </td></tr>
</table>
<p>还提供标准int类型集： </p>
<table class="doxtable">
<tr>
<th>类型名 </th><th>描述  </th></tr>
<tr>
<td>int8 </td><td>8位有符号整形 </td></tr>
<tr>
<td>int16 </td><td>16位有符号整形 </td></tr>
<tr>
<td>int32 </td><td>32位有符号整形 </td></tr>
<tr>
<td>int64 </td><td>64位有符号整形 </td></tr>
<tr>
<td>uint8 </td><td>8位无符号整形 </td></tr>
<tr>
<td>uint16 </td><td>16位无符号整形 </td></tr>
<tr>
<td>uint32 </td><td>32位无符号整形 </td></tr>
<tr>
<td>uint64 </td><td>64位无符号整形 </td></tr>
</table>
<h4>复合类型</h4>
<p>使用struct结构体，可以像C语言一样，轻松定义复合类型 </p>
<pre class="fragment">struct pair {
    int x;
    int y;
}
</pre><p>然而复合类型在使用时，是以C语言指针的形式使用的，一般我们不推荐直接在一个复合类型中嵌入复合类型对象，而是直接嵌入引用： </p>
<pre class="fragment">struct Node {
    int data;
    Node next;
}
</pre><p>这里的Node，是指向结构体的指针，而非直接嵌入该结构体成员，所以上面的代码是能够正确使用的。 如果您希望嵌入结构体成员时，请在类型名使用<code>*</code>符号，这个特性适合C语言风格的结构体继承。（目前不安全的特性） </p>
<pre class="fragment">struct Node {
    *DataSet dataset;
    Node next;
}

struct DataSet {
    int count;
    char[] data;
}
</pre><p>复合类型的使用，和C语言类似，是使用<code>.</code>运算符进行的： </p>
<pre class="fragment">int dot(pair a, pair b) {
    int k = a.x + b.y;
    printf("k = %d\n", k);
    return k;
}
</pre><h4>数组类型</h4>
<p>和C语言不同，Elite默认语言里原生支持变长数组类型，数组类型均为堆分配的数组指针。 </p>
<pre class="fragment">int[] g = new int[10];
g[0] = 1;
</pre><p>该数组可以在调用C函数时，直接作为C数组传入</p>
<p>同时，支持二维数组及高维数组： </p>
<pre class="fragment">int[][] g = new int[10][5];
</pre><p>Elite和C数组最大的不同，在于Elite数组中记录有每一维的长度信息，这个长度信息是存放在数组地址前面的字节中，内存布局如下：</p>
<p>![Elite数组内存布局]()</p>
<h2><a class="anchor" id="lang-ref-basic-memory"></a>
内存管理</h2>
<p>Elite的内存管理是可配置的，首先Elite语言本身支持C语言的内存管理，使用malloc和free封装后的接口，new和delete，使用方式和C++几乎一致。</p>
<p>可以new单独的对象 </p>
<pre class="fragment">struct Person {
    char[] name;
    int age;
}

int main() {
    Person person = new Persion;
    return 0;
}
</pre><p>也可以构建数组或对象数组 </p>
<pre class="fragment">int main() {
    Person[] persons = new Persion[20];
    return 0;
}
</pre><p>使用后的内存，需要使用delete语句手动释放。 </p>
<pre class="fragment">delete person;      // 释放单个指针
delete[] persons;   // 释放数组指针
</pre><h1><a class="anchor" id="lang-ref-macro"></a>
强大的宏机制</h1>
<p>Elite语言内置了类似lisp风格的宏，拥有强大的表达能力，很多情况下，无需改变语法结构，已经能够让您自定义许多常见语法。</p>
<p>宏的使用示例如下：</p>
<pre class="fragment">void print(int k) {
    @for_n (i, k) {
        printf("hello-%d\n", i);
    }
}

defmacro for_n (p, size, code)  {
    for (int p = 1; p &lt;= size; p = p+1)
        code;
}

int main() {
    print(5);
    return 0;
}
</pre><p>和函数不同的是，宏使用<code>defmacro</code>关键字定义，是一个编译时函数，运行时不会再存在宏，通过宏，我们能够实现许多自定义的语法。 例如上面例子中的<code>for_n</code>宏，我们只需简要的包装一下，接口正确的翻译。</p>
<p>宏的调用要显式的使用<code>@</code>符。</p>
<p>宏调用的基本格式为： </p>
<pre class="fragment">@ &lt;宏符号名&gt; &lt;参数列表&gt;
</pre><p>宏的语法十分独特，由于宏调用的宽泛性，我们支持在宏运算符后加如下几种结构，作为参数列表中的参数：</p>
<ul>
<li>括号表示式 形如：<code>( 元素, 元素 )</code> ， 每一个元素都会作为一个参数</li>
<li>id标识符 任意一个字符串， 会单独作为一个参数</li>
<li>大括号表达式 形如：<code>{ ... code ... }</code>，往往是一个代码段，整体作为一个参数 </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
  </ul>
</div>
</body>
</html>
